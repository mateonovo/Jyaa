<!-- create-product.component.html -->

<div class="container mt-5">
  <h2 class="mb-4">Registrar Producto</h2>
  <form (ngSubmit)="registerProduct(registerForm)" #registerForm="ngForm">

    <div class="form-group">
      <label for="nombre">Nombre:</label>
      <input type="text" class="form-control" id="nombre" [(ngModel)]="producto.nombre" name="nombre" required>
    </div>

    <div class="form-group">
      <label for="fechaEnvasado">Fecha de Envasado:</label>
      <input type="date" class="form-control" id="fechaEnvasado" [(ngModel)]="producto.fechaEnvasado" name="fechaEnvasado" required>
    </div>
    
    <div class="form-group">
      <label for="fechaVencimiento">Fecha de Vencimiento:</label>
      <input type="date" class="form-control" id="fechaVencimiento" [(ngModel)]="producto.fechaVencimiento" name="fechaVencimiento" required>
    </div>
    
    <div class="form-group">
      <label for="precioVenta">Precio de Venta:</label>
      <input type="number" class="form-control" id="precioVenta" [(ngModel)]="producto.precioVenta" name="precioVenta" required>
    </div>

    <div class="form-group">
      <label for="cantidadProductos">Cantidad de Productos:</label>
      <input type="number" class="form-control" id="cantidadProductos" [(ngModel)]="producto.cantidadProductos" name="cantidadProductos" required>
    </div>

    <div formArrayName="insumos">
      <div *ngFor="let item of producto.insumos; let i = index" class="form-group">
        <label for="insumoId">Insumo:</label>
        <select class="form-control" [(ngModel)]="item.insumo" name="insumoId-{{i}}" required>
          <option *ngFor="let insumo of insumos" [value]="insumo.id">{{ insumo.nombre }}</option>
        </select>
        <label for="cantidad">Cantidad:</label>
        <input type="number" class="form-control" [(ngModel)]="item.cantidad" name="cantidad-{{i}}" required>
        <button type="button" class="btn btn-danger mt-2" (click)="eliminarItemDeInsumo(i)">Eliminar</button>
      </div>
      <button type="button" class="btn btn-secondary mt-2" (click)="agregarItemDeInsumo()">Agregar Insumo</button>
    </div>
    
    <button type="submit" class="btn btn-primary mt-3">Registrar</button>
  </form>
  
  <div *ngIf="errorMessage" class="alert alert-danger mt-3">
    <p>{{ errorMessage }}</p>
  </div>
  
  <div *ngIf="successMessage" class="alert alert-success mt-3">
    <p>{{ successMessage }}</p>
  </div>
</div>
